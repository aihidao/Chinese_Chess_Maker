<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_ui_upload</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>obj_button</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>image_index=0;
image_speed=0;
var post="";
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="7">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>global.game_info=ds_map_create();

//------------------------------------------
    for(j=0;j&lt;global.COL;j++){
         for(i=0;i&lt;global.ROW;i++){
            global.county[i,j]=0;
        }
    }
for(k=0;k&lt;instance_number(obj_county);k++){
            temp=instance_find(obj_county,k);
            global.county[temp.x/50,temp.y/50]=1;
}
//------------------------------------------开始收集数据
global.board_info=ds_list_create();
global.map_info=ds_list_create();
global.pieces_info=ds_list_create();
global.county_info=ds_list_create();
global.side_info=ds_list_create();
global.player_info=ds_list_create();


for(i=0;i&lt;global.ROW;i++){
    for(j=0;j&lt;global.COL;j++){
        ds_list_add(global.map_info, global.game_map[i,j]);
        ds_list_add(global.pieces_info,global.pieces[i,j]);
        ds_list_add(global.board_info,global.board[i,j]);
        ds_list_add(global.county_info,global.county[i,j]);
    }
}

for(i=0;i&lt;global.player_number;++i){
    for(j=0;j&lt;8;j++){
        ds_list_add(global.player_info,global.player[i,j]);
    }
}

for(i=0;i&lt;8;++i){
    ds_list_add(global.side_info,global.player_side[i]);
}

ds_map_add(global.game_info, "map_name", global.map_name); 
ds_map_add(global.game_info, "ROW", global.ROW);
ds_map_add(global.game_info, "COL", global.COL);
ds_map_add(global.game_info, "player_number", global.player_number);
ds_map_add_list(global.game_info, "map_info", global.map_info);
ds_map_add_list(global.game_info, "board_info", global.board_info);
ds_map_add_list(global.game_info, "pieces_info", global.pieces_info);
ds_map_add_list(global.game_info, "county_info", global.county_info);
ds_map_add_list(global.game_info, "player_info", global.player_info);
ds_map_add_list(global.game_info, "side_info", global.side_info);

global.game_json=json_encode(global.game_info);
var str="map_name="+global.map_name+"&amp;map_json="+global.game_json+"&amp;player_num="+ string_format(global.player_number,0,0);
post = http_post_string("http://localhost:8080/CCM_SCP/save_map.php", str);
//var game_file= file_text_open_write(working_directory+"/gamemap/"+global.map_name+".cmap");
//file_text_write_string(game_file, global.game_json);
//file_text_close(game_file);

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="62">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>var r_str = "null";
if ds_map_find_value(async_load, "id") == post
   {
   if ds_map_find_value(async_load, "status") == 0
      {
      r_str = ds_map_find_value(async_load, "result");
      }else{
        r_str="可能网络没有连接!";
      }
   }
   
   global.ME_mes=r_str;
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
